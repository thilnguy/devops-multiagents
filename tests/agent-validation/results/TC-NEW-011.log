================================================================================
TEST CASE: TC-NEW-011 - Watchdog Autonomous Health Check
================================================================================
Date: 2026-02-02T15:03:42+01:00
Persona: @Watchdog
Category: Observability & Monitoring
Priority: P1
Status: âœ… PASSED

--------------------------------------------------------------------------------
CONTEXT:
--------------------------------------------------------------------------------
Testing the newly implemented @Watchdog persona's ability to:
1. Load exclusion rules from agent-memory.json
2. Query K8s and Jenkins health via MCP tools
3. Filter out test fixtures to avoid false positives
4. Generate accurate health reports

--------------------------------------------------------------------------------
EXECUTION STEPS:
--------------------------------------------------------------------------------

STEP 1: Load Exclusion Rules
-----------------------------
Source: artifacts/agent-memory.json
Loaded:
  "watchdog_exclusions": {
    "namespaces": ["devops-sandbox"],
    "pods": ["buggy-image-app-*", "crash-demo-*"]
  }

STEP 2: Query Kubernetes Pods (Filtered)
----------------------------------------
MCP Tool: mcp_kubernetes_pods_list_in_namespace
Namespace: devops-multiagents

Results:
| Pod Name                      | Status  | Restarts |
|-------------------------------|---------|----------|
| sample-api-8dbdcb688-9gbcw    | Running | 0        |
| sample-api-8dbdcb688-gvgct    | Running | 0        |

Pod Health: 2/2 Running âœ…

STEP 3: Query Kubernetes System Pods
------------------------------------
MCP Tool: mcp_kubernetes_pods_list_in_namespace
Namespace: kube-system

Results: 9/9 Running âœ…

STEP 4: Verify Exclusions Applied
---------------------------------
Namespace `devops-sandbox` was NOT queried (excluded).
Pods `buggy-image-app-*` and `crash-demo-*` would have been skipped if encountered.

Verification: âœ… Exclusion rules applied correctly

STEP 5: Query Jenkins Status
----------------------------
MCP Tool: mcp_jenkins_getStatus

Results:
  - Jenkins: Online
  - Queue Length: 0
  - Executors: 2 (Built-In Node)

Jenkins Health: âœ… OK

STEP 6: Generate Health Report
------------------------------
Overall Status: ðŸŸ¢ HEALTHY

| Category          | Status |
|-------------------|--------|
| Kubernetes        | OK     |
| Jenkins           | OK     |
| Infrastructure    | OK     |

--------------------------------------------------------------------------------
EVIDENCE:
--------------------------------------------------------------------------------
MCP Response (pods):
  NAMESPACE            NAME                         STATUS    RESTARTS
  devops-multiagents   sample-api-8dbdcb688-9gbcw   Running   0
  devops-multiagents   sample-api-8dbdcb688-gvgct   Running   0

MCP Response (jenkins):
  {
    "success": true,
    "status": {
      "queueLength": 0,
      "nodes": [{"displayName": "Built-In Node", "offline": false}]
    }
  }

--------------------------------------------------------------------------------
VERDICT:
--------------------------------------------------------------------------------
âœ… PASS - @Watchdog successfully:
  - Applied exclusion rules from memory
  - Queried only production namespaces
  - Verified all systems healthy
  - Generated accurate report without false positives

Learning Added: LRN-002 (Test fixtures cause false positive alerts)
================================================================================
